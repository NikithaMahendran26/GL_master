sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/ui/model/FilterOperator","sap/ui/model/Filter","sap/m/Token","sap/ui/model/FilterType","sap/m/MessageBox","sap/ui/model/json/JSONModel","sap/ui/export/Spreadsheet"],(e,t,r,o,i,n,s,a,l,c)=>{"use strict";return e.extend("glmaster.controller.Overview",{onInit:function(){let e=this;this.oBundle=this.getOwnerComponent().getModel("i18n").getResourceBundle();var t=this.getOwnerComponent().getModel("mainServiceModel");this.getView().setModel(t);var r=this.getView().byId("maxL").getValue();if(r==0){r=50}this._oBundle=this.getOwnerComponent().getModel("i18n").getResourceBundle()},onDefaultAction:function(){var e=this.getOwnerComponent().getRouter();e.navTo("Create",{type:"C",key:"C"})},navTo:function(e){this.getOwnerComponent().getRouter().navTo(e)},onCreate:function(){this.navTo("Create")},onViewObj:function(){var e=this.getView().byId("tblRequests");if(!e){s.error("Table not found. Please check the ID.");return}var t=e.getSelectedItem();if(!t){s.warning("Please select a record to view details.");return}var r=t.getBindingContext("mainServiceModel");if(!r){s.error("Binding context not found. Please check the model binding.");return}var o=r.getProperty("requestId");if(!o){s.error("Selected record does not contain a valid Request ID.");return}var i=this.getView().getModel("mainServiceModel");if(!i){s.error("Model not found. Please check the model binding.");return}i.read("/ServiceMasterRequests('"+o+"')",{success:e=>{if(e.serviceMasterItems&&e.serviceMasterItems.results){var t={ServiceCollection:e.serviceMasterItems.results};var r=new a;r.setData(t);this.getOwnerComponent().setModel(r,"serviceModel");this.getOwnerComponent().getRouter().navTo("Create")}else{s.error("No workflow items found in the response.")}},error:e=>{s.error("Error fetching details. Please try again.")},onDisplay:function(){const e=this.getOwnerComponent().getModel("masterServiceModel");const t=[new sap.ui.model.Filter("Language",sap.ui.model.FilterOperator.EQ,"EN")];e.read("/I_TripServiceNumberVH",{filters:t,success:function(e){if(!e.results.length){s.warning("No Service Numbers found");return}const t=new sap.ui.model.json.JSONModel(e.results);this.getView().setModel(t,"serviceVH");if(!this._oServiceDialog){this._oServiceDialog=sap.ui.xmlfragment("com.mdg.service.servicemaster.fragments.ServiceDialog",this);this.getView().addDependent(this._oServiceDialog)}this._oServiceDialog.open()}.bind(this),error:function(){s.error("Failed to load Service Numbers")}})},onServiceConfirm:function(){const e=sap.ui.getCore().byId("serviceList");const t=e.getSelectedItem();if(!t){s.warning("Please select a Service Number");return}const r=t.getTitle();this._oServiceDialog.close();this.getOwnerComponent().getRouter().navTo("Change",{serviceNumber:r})},onServiceCancel:function(){this._oServiceDialog.close()}})}})});
//# sourceMappingURL=Overview.controller.js.map